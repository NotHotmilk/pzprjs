/*! @license pzpr.js v1375cc80 (c) 2009-2025 sabo2, MIT license
 *   https://github.com/sabo2/pzprv3 */
!function(t,e){"object"==typeof module&&module.exports?module.exports=[t,e]:pzpr.classmgr.makeCustom(t,e)}(["kurarin"],{MouseEvent:{use:!0,inputModes:{edit:["info-line"],play:["line","peke","shade","unshade","info-line"]},mouseinputAutoPlay:function(){this.mousestart||this.mousemove?"left"===this.btn?(this.inputCopyShade(),this.inputLine()):"right"!==this.btn||this.mousestart&&this.inputpeke_ifborder()||this.firstCell.isnull&&!this.notInputted()||this.inputcell():this.mouseend&&this.notInputted()&&(this.inputData=null,this.mouseCell=this.board.emptycell,this.inputcell())},inputCopyShade:function(){var t;10!==this.inputData&&!this.mousestart||(t=this.getcell()).isnull||t===this.mouseCell||this.mousestart&&!t.isShade()||(this.inputData=10,(this.mouseCell=t).allowShade()&&1!==t.qans&&(t.setQans(1),t.setQsub(0),t.draw()))},inputdot:function(){var t=this.getpos(.25);if(t.isinside()){if(!this.cursor.equals(t))return this.setcursor(t),void t.draw();var e,t=t.getDot();null!==t&&(e=t.getDot(),"left"===this.btn?3===e?t.setDot(0):t.setDot(e+1):"right"===this.btn&&(0===e?t.setDot(3):t.setDot(e-1)),t.draw())}},mouseinputAutoEdit:function(){this.mousestart&&this.inputdot()}},KeyEvent:{enablemake:!0,moveTarget:function(t){return this.moveTBorder(t)},keyinput:function(t){this.key_inputdot(t)},key_inputdot:function(t){var e,i=this.cursor.getDot();null!==i&&(0<=(e=+t)&&e<=3?i.setDot(e):" "!==t&&"-"!==t||i.setDot(0),i.draw())}},Cell:{noLP:function(t){return this.isShade()},allowShade:function(){return 0===this.lcnt},qnum:0,minnum:0,maxnum:3,dotCells:function(){return new this.klass.CellList([this])},isDot:function(){return 0===this.lcnt&&1===this.qsub}},Cross:{qnum:0,minnum:0,maxnum:3,dotCells:function(){var t=this.bx,e=this.by;return this.board.cellinside(t-1,e-1,t+1,e+1)}},Border:{enableLineNG:!0,qnum:0,minnum:0,maxnum:3,dotCells:function(){return new this.klass.CellList(this.sidecell)}},Board:{hascross:1,hasborder:1,hasdots:1},Dot:{setDot:function(t){this.puzzle.opemgr.disCombine=!0,this.piece.setQnum(t),this.puzzle.opemgr.disCombine=!1}},LineGraph:{enabled:!0},Graphic:{gridcolor_type:"LIGHT",irowake:!0,shadecolor:"#444444",enablebcolor:!0,paint:function(){this.drawBGCells(),this.drawShadedCells(),this.drawDotCells(),this.drawGrid(),this.drawDots(),this.drawChassis(),this.drawLines(),this.drawPekes(),this.drawCursor(!1,this.puzzle.editmode)},getDotRadius:function(){return.16},getDotFillColor:function(t){switch(t.getDot()){case 1:return this.quescolor;case 2:return"#ccc";case 3:return"white";default:return null}},getDotOutlineColor:function(t){return 1<=t.getDot()?t.iserror()?this.errcolor1:this.quescolor:null}},Encode:{decodePzpr:function(t){this.decodeKurarin()},encodePzpr:function(t){this.encodeKurarin()},decodeKurarin:function(){var n=this.board;this.genericDecodeNumber16(n.dots.length>>1|1,function(t,e){var i=n.dots[2*t],t=n.dots[2*t+1];i.setDot(e>>2&3),t&&t.setDot(3&e)})},encodeKurarin:function(){var i=this.board;this.genericEncodeNumber16(i.dots.length>>1|1,function(t){var e=i.dots[2*t],t=i.dots[2*t+1],e=e.getDot()<<2|(t?t.getDot():0);return 0<e?e:-1})}},FileIO:{decodeData:function(){this.decodeDotFile(),this.decodeCellAns(),this.decodeBorderLine()},encodeData:function(){this.encodeDotFile(),this.encodeCellAns(),this.encodeBorderLine()}},AnsCheck:{checklist:["checkBranchLine","checkCrossLine","checkLineOnShadeCell","checkShadeWhite","checkShadeBlack","checkShadeGray","checkDeadendLine+","checkOneLoop","checkEmptyCell_kurarin"],checkShadeBlack:function(){this.checkShadeOnDot(1,"csDotBlack")},checkShadeGray:function(){this.checkShadeOnDot(2,"csDotGray")},checkShadeWhite:function(){this.checkShadeOnDot(3,"csDotWhite")},checkShadeOnDot:function(t,e){for(var i=this.board,n=0;n<i.dotsmax;n++){var s=i.dots[n];if(s.getDot()===t){var o=s.piece.dotCells(),o=2*o.filter(function(t){return t.isShade()}).length-o.length;if(!(1===t&&0<o||2===t&&0==o||3===t&&o<0)){if(this.failcode.add(e),this.checkOnly)break;s.piece.seterr(1),s.piece.dotCells().seterr(1)}}}},checkEmptyCell_kurarin:function(){this.checkAllCell(function(t){return 0===t.lcnt&&!t.isShade()},"ceEmpty")}},FailCode:{ceEmpty:"ceEmpty.yajilin"}});